#!/bin/bash
set -eux

if ! [ -x "$(command -v keybase)" ]; then
  {{- if eq .chezmoi.os "darwin" }}
  echo "Visit https://keybase.io/docs/the_app/install_macos to install Keybase"
  {{- else if or (eq .chezmoi.osRelease.name "Ubuntu") (eq .chezmoi.osRelease.name "elementary OS") }}
  curl --remote-name https://prerelease.keybase.io/keybase_amd64.deb
  sudo apt install ./keybase_amd64.deb
  run_keybase
  {{- end }}
fi

if [ ! -d "${HOME}/.tmux/plugins/tpm" ]; then
  git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm
fi

if ! [ -x "$(command -v gpgconf)" ]; then
  {{- if eq .chezmoi.os "darwin" }}
  brew install gnupg
  {{- else }}
  echo "python in ubuntu not supported"
  {{- end }}
fi

if ! [ -x "$(command -v pet)" ]; then
  {{- if eq .chezmoi.os "darwin" }}
  brew install knqyf263/pet/pet
  {{- else }}
  echo "python in ubuntu not supported"
  {{- end }}
fi

if ! [ -x "$(command -v fd)" ]; then
  {{- if eq .chezmoi.os "darwin" }}
  brew install fd
  {{- else }}
  echo "python in ubuntu not supported"
  {{- end }}
fi

if ! [ -x "$(command -v delta)" ]; then
  {{- if eq .chezmoi.os "darwin" }}
  brew install git-delta
  {{- else }}
  echo "python in ubuntu not supported"
  {{- end }}
fi

if ! [ -x "$(command -v golangci-lint)" ]; then
  {{- if eq .chezmoi.os "darwin" }}
  brew install golangci-lint
  {{- else }}
  echo "non-darwin not supported"
  {{- end }}
fi

if ! [ -x "$(command -v pgcli)" ]; then
  {{- if eq .chezmoi.os "darwin" }}
  brew install pgcli
  {{- else }}
  echo "non-darwin not supported"
  {{- end }}
fi

if ! [ -x "$(command -v tmuxinator)" ]; then
  {{- if eq .chezmoi.os "darwin" }}
  brew install tmuxinator
  {{- else }}
  echo "tmuxinator in non-darwin not supported"
  {{- end }}
fi
